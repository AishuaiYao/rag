"E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\.venv\Scripts\python.exe" "E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py"
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:2: LangChainDeprecationWarning: Importing HuggingFaceEmbeddings from langchain.embeddings is deprecated. Please replace deprecated imports:

>> from langchain.embeddings import HuggingFaceEmbeddings

with new imports of:

>> from langchain_community.embeddings import HuggingFaceEmbeddings
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/docs/versions/v0_2/>
  from langchain.embeddings import HuggingFaceEmbeddings
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:3: LangChainDeprecationWarning: Importing Chroma from langchain.vectorstores is deprecated. Please replace deprecated imports:

>> from langchain.vectorstores import Chroma

with new imports of:

>> from langchain_community.vectorstores import Chroma
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/docs/versions/v0_2/>
  from langchain.vectorstores import Chroma
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:4: LangChainDeprecationWarning: Importing BM25Retriever from langchain.retrievers is deprecated. Please replace deprecated imports:

>> from langchain.retrievers import BM25Retriever

with new imports of:

>> from langchain_community.retrievers import BM25Retriever
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/docs/versions/v0_2/>
  from langchain.retrievers import BM25Retriever, EnsembleRetriever
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:5: LangChainDeprecationWarning: Importing DirectoryLoader from langchain.document_loaders is deprecated. Please replace deprecated imports:

>> from langchain.document_loaders import DirectoryLoader

with new imports of:

>> from langchain_community.document_loaders import DirectoryLoader
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/docs/versions/v0_2/>
  from langchain.document_loaders import DirectoryLoader, PyPDFLoader, TextLoader
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:5: LangChainDeprecationWarning: Importing PyPDFLoader from langchain.document_loaders is deprecated. Please replace deprecated imports:

>> from langchain.document_loaders import PyPDFLoader

with new imports of:

>> from langchain_community.document_loaders import PyPDFLoader
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/docs/versions/v0_2/>
  from langchain.document_loaders import DirectoryLoader, PyPDFLoader, TextLoader
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:5: LangChainDeprecationWarning: Importing TextLoader from langchain.document_loaders is deprecated. Please replace deprecated imports:

>> from langchain.document_loaders import TextLoader

with new imports of:

>> from langchain_community.document_loaders import TextLoader
You can use the langchain cli to **automatically** upgrade many imports. Please see documentation here <https://python.langchain.com/docs/versions/v0_2/>
  from langchain.document_loaders import DirectoryLoader, PyPDFLoader, TextLoader
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:8: UserWarning: WARNING: Unsloth should be imported before transformers, peft to ensure all optimizations are applied. Your code may run slower or encounter memory issues without these optimizations.

Please restructure your imports with 'import unsloth' at the top of your file.
  from unsloth import FastLanguageModel
ğŸ¦¥ Unsloth: Will patch your computer to enable 2x faster free finetuning.
Unsloth: Failed to patch Gemma3ForConditionalGeneration.
ğŸ¦¥ Unsloth Zoo will now patch everything to make training faster!
å¼€å§‹åˆå§‹åŒ–RAGç³»ç»Ÿ...
å¼€å§‹è¿›è¡Œæ–‡æ¡£å¤„ç†...
æ­£åœ¨åˆå§‹åŒ–åµŒå…¥æ¨¡å‹...
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:21: LangChainDeprecationWarning: The class `HuggingFaceEmbeddings` was deprecated in LangChain 0.2.2 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-huggingface package and should be used instead. To use it run `pip install -U :class:`~langchain-huggingface` and import as `from :class:`~langchain_huggingface import HuggingFaceEmbeddings``.
  self.embed_model = HuggingFaceEmbeddings(
åµŒå…¥æ¨¡å‹åˆå§‹åŒ–å®Œæˆã€‚
å¼€å§‹åŠ è½½æ–‡æ¡£...
æ–‡æ¡£åŠ è½½å®Œæˆã€‚
å¼€å§‹è¿›è¡Œè¯­ä¹‰åˆ†å—...
è¯­ä¹‰åˆ†å—å®Œæˆã€‚
å¼€å§‹è¿›è¡ŒäºŒæ¬¡åŠ¨æ€åˆ†å—...
äºŒæ¬¡åŠ¨æ€åˆ†å—å®Œæˆã€‚
å¼€å§‹ä¸ºæ¯ä¸ªå—æ·»åŠ å…ƒæ•°æ®...
å…ƒæ•°æ®æ·»åŠ å®Œæˆã€‚
æ–‡æ¡£å¤„ç†å®Œæˆã€‚
å¼€å§‹åˆå§‹åŒ–æ··åˆæ£€ç´¢å™¨...
è¯­ä¹‰åˆ†å—è¿›åº¦: 100%|â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ| 1/1 [00:00<?, ?it/s]
å‘ç°æœ¬åœ°å·²å­˜åœ¨å‘é‡æ•°æ®åº“ï¼Œæ­£åœ¨åŠ è½½...
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:109: LangChainDeprecationWarning: The class `Chroma` was deprecated in LangChain 0.2.9 and will be removed in 1.0. An updated version of the class exists in the :class:`~langchain-chroma package and should be used instead. To use it run `pip install -U :class:`~langchain-chroma` and import as `from :class:`~langchain_chroma import Chroma``.
  self.vector_db = Chroma(persist_directory=persist_directory, embedding_function=embedding)
æœ¬åœ°å‘é‡æ•°æ®åº“åŠ è½½å®Œæˆã€‚
å¼€å§‹åˆ›å»ºBM25æ£€ç´¢å™¨...
BM25æ£€ç´¢å™¨åˆ›å»ºå®Œæˆã€‚
å¼€å§‹åˆ›å»ºæ··åˆæ£€ç´¢å™¨...
æ··åˆæ£€ç´¢å™¨åˆ›å»ºå®Œæˆã€‚
å¼€å§‹åˆå§‹åŒ–é‡æ’åºæ¨¡å‹...
é‡æ’åºæ¨¡å‹åˆå§‹åŒ–å®Œæˆã€‚
æ··åˆæ£€ç´¢å™¨åˆå§‹åŒ–å®Œæˆã€‚
å¼€å§‹åŠ è½½å¾®è°ƒåçš„è¯­è¨€æ¨¡å‹...
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\.venv\lib\site-packages\unsloth_zoo\gradient_checkpointing.py:330: UserWarning: expandable_segments not supported on this platform (Triggered internally at C:\actions-runner\_work\pytorch\pytorch\pytorch\c10/cuda/CUDAAllocatorConfig.h:28.)
  GPU_BUFFERS = tuple([torch.empty(2*256*2048, dtype = dtype, device = f"cuda:{i}") for i in range(n_gpus)])
==((====))==  Unsloth 2025.3.19: Fast Qwen2 patching. Transformers: 4.51.2.
   \\   /|    NVIDIA GeForce GTX 1650. Num GPUs = 1. Max memory: 4.0 GB. Platform: Windows.
O^O/ \_/ \    Torch: 2.6.0+cu124. CUDA: 7.5. CUDA Toolkit: 12.4. Triton: 3.2.0
\        /    Bfloat16 = FALSE. FA [Xformers = 0.0.29.post3. FA2 = False]
 "-____-"     Free license: http://github.com/unslothai/unsloth
Unsloth: Fast downloading is enabled - ignore downloading bars which are red colored!
Sliding Window Attention is enabled but not implemented for `eager`; unexpected results may be encountered.
models/DeepSeek-R1-Distill-Qwen-1.5B does not have a padding token! Will use pad_token = <|vision_pad|>.
E:\3-è½¯ä»¶\PyCharm Community Edition 2024.3.5\PythonProject\RAG\process_case.py:147: LangChainDeprecationWarning: The method `BaseRetriever.get_relevant_documents` was deprecated in langchain-core 0.1.46 and will be removed in 1.0. Use :meth:`~invoke` instead.
  docs = self.ensemble_retriever.get_relevant_documents(query)
å¾®è°ƒåçš„è¯­è¨€æ¨¡å‹åŠ è½½å®Œæˆã€‚
RAGç³»ç»Ÿåˆå§‹åŒ–å®Œæˆã€‚
å¼€å§‹å¤„ç†é—®é¢˜ï¼š
    {
        "requestid": "306a7b8e-17b0-11f0-b173-e02be94eee68",
        "path1": {
            "traceid": "306a7b8f-17b0-11f0-b5d9-e02be943ee63",
            "length": 589,
            "turnleft": 4,
            "turnright": 4,
            "safescore": 4.3
        },
        "path2": {
            "traceid": "306a7b90-17b0-11f0-af97-e02be943ee62",
            "length": 549,
            "turnleft": 4,
            "turnright": 4,
            "safescore": 4.9
        }
    }

å¼€å§‹ä½¿ç”¨æ£€ç´¢å™¨è·å–ä¸é—®é¢˜ç›¸å…³çš„ä¸Šä¸‹æ–‡...
å¼€å§‹ä½¿ç”¨æ··åˆæ£€ç´¢å™¨è·å–ç›¸å…³æ–‡æ¡£...
æ··åˆæ£€ç´¢å™¨è·å–ç›¸å…³æ–‡æ¡£å®Œæˆã€‚
å¼€å§‹ä½¿ç”¨é‡æ’åºæ¨¡å‹è¿›è¡Œé‡æ’åº...
é‡æ’åºå®Œæˆã€‚
ä¸é—®é¢˜ç›¸å…³çš„ä¸Šä¸‹æ–‡è·å–å®Œæˆã€‚
å¼€å§‹æ ¹æ®é—®é¢˜å’Œä¸Šä¸‹æ–‡ç”Ÿæˆæç¤º...
æç¤ºç”Ÿæˆå®Œæˆã€‚
å¼€å§‹ä½¿ç”¨è¯­è¨€æ¨¡å‹ç”Ÿæˆå›ç­”...
The attention mask is not set and cannot be inferred from input because pad token is same as eos token. As a consequence, you may observe unexpected behavior. Please pass your input's `attention_mask` to obtain reliable results.
è¯­è¨€æ¨¡å‹å›ç­”ç”Ÿæˆå®Œæˆã€‚
é—®é¢˜å¤„ç†å®Œæˆã€‚
[é—®é¢˜ï¼š
    {
        "requestid": "306a7b8e-17b0-11f0-b173-e02be94eee68",
        "path1": {
            "traceid": "306a7b8f-17b0-11f0-b5d9-e02be943ee63",
            "length": 589,
            "turnleft": 4,
            "turnright": 4,
            "safescore": 4.3
        },
        "path2": {
            "traceid": "306a7b90-17b0-11f0-af97-e02be943ee62",
            "length": 549,
            "turnleft": 4,
            "turnright": 4,
            "safescore": 4.9
        }
    }
    ]
>ç­”æ¡ˆï¼š
>ä½ æ˜¯ä¸€ä¸ªcaseåˆ†æåŠ©æ‰‹ï¼Œè¯·ä¸¥æ ¼æ ¹æ®ä»¥ä¸‹æ¥æºçš„caseé‡Œç»™å‡ºçš„bestå’Œreasonæƒ…å†µï¼Œåˆ¤æ–­é—®é¢˜é‡Œé‚£ä¸ªpathæ›´å¥½:
  [æ¥æºï¼šdataset\cases.txtï¼Œç±»å‹ï¼šnormal]
{
    "requestid": "306a7b8e-17b0-11f0-b173-e02be943ee68",
    "path1": {
        "traceid": "306a7b8f-17b0-11f0-b5d9-e02be943ee68",
        "length": 43,
        "turnleft": 4,
        "turnright": 4,
        "safescore": 4.3
    },
    "path2": {
        "traceid": "306a7b90-17b0-11f0-af97-e02be943ee68",
        "length": 52,
        "turnleft": 4,
        "turnright": 4,
        "safescore": 4.2
    },
    "best": "path1",
    "reason": "shorter than path2 and safe than path2"
}

[æ¥æºï¼šdataset\cases.txtï¼Œç±»å‹ï¼šnormal]
"route_length": 53,
        "turnleft": 4,
        "turnright": 4,
        "safescore": 4.2
    },
    "path2": {
        "traceid": "52847d0e-17af-11f0-8f6d-e02be943ee68",
        "route_length": 53,
        "turnleft": 4,
        "turnright": 4,
        "safescore": 4.2
    }
}
{
    "requestid": "52847d0f-17af-11f0-ab4c-e02be943ee68",
    "path1": {
        "traceid": "52847d10-17af-11f0-8978-e02be943ee68",
        "route_length": 53,
        "turnleft": 4,
        "turnright": 4,

[æ¥æºï¼šdataset\cases.txtï¼Œç±»å‹ï¼šnormal]
"route_length": 53,
        "turnleft": 4,
        "turnright": 4,
        "safescore": 4.2
    },
    "path2": {
        "traceid": "52847d11-17af-11f0-95b6-e02be943ee68",
        "route_length": 53,
        "turnleft": 4,
        "turnright": 4,
        "safescore": 4.2
    }
}
{
    "requestid": "52847d12-17af-11f0-8858-e02be943ee68",
    "path1": {
        "traceid": "52847d13-17af-11f0-8c11-e02be943ee68",
        "route_length": 53,
        "turnleft": 4,
        "turnright": 4,
>æŒ‰æ­¥éª¤æ€è€ƒå¹¶å›ç­”ï¼š
    {
        "requestid": "306a7b8e-17b0-11f0-b173-e02be94eee68",
        "path1": {
            "traceid": "306a7b8f-17b0-11f0-b5d9-e02be943ee63",
            "length": 589,
            "turnleft": 4,
            "turnright": 4,
            "safescore": 4.3
        },
        "path2": {
            "traceid": "306a7b90-17b0-11f0-af97-e02be943ee62",
            "length": 549,
            "turnleft": 4,
            "turnright": 4,
            "safescore": 4.9
        }
    }

>å¦‚æœä¸Šä¸‹æ–‡ä¿¡æ¯ä¸è¶³ï¼Œè¯·æ˜ç¡®æŒ‡å‡ºç¼ºå¤±çš„ä¿¡æ¯ã€‚æœ€åç”¨ä¸­æ–‡ç»™å‡ºç»“æ„åŒ–ç­”æ¡ˆã€‚"
</think>

æ ¹æ®æä¾›çš„ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œè·¯å¾„1ï¼ˆ"path1"ï¼‰çš„é•¿åº¦ä¸º589ï¼Œsafescoreä¸º4.3ï¼Œè€Œè·¯å¾„2ï¼ˆ"path2"ï¼‰çš„é•¿åº¦ä¸º549ï¼Œsafescoreä¸º4.9ã€‚è·¯å¾„1æ›´çŸ­ï¼ŒåŒæ—¶safescoreä¹Ÿæ¯”è·¯å¾„2é«˜ï¼Œå› æ­¤è·¯å¾„1æ›´ä¼˜ã€‚

è¿›ç¨‹å·²ç»“æŸï¼Œé€€å‡ºä»£ç ä¸º 0
